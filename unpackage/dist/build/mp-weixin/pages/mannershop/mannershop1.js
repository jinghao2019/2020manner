(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/mannershop/mannershop1"],{"04fb":function(e,t,n){"use strict";n.r(t);var o=n("50b9"),r=n.n(o);for(var s in o)"default"!==s&&function(e){n.d(t,e,(function(){return o[e]}))}(s);t["default"]=r.a},"06cf":function(e,t,n){"use strict";(function(e){n("4262"),n("921b");o(n("66fd"));var t=o(n("73b7"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"4d3b":function(e,t,n){"use strict";var o,r=function(){var e=this,t=e.$createElement;e._self._c},s=[];n.d(t,"b",(function(){return r})),n.d(t,"c",(function(){return s})),n.d(t,"a",(function(){return o}))},"50b9":function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=s(n("4795")),r=n("2f62");function s(e){return e&&e.__esModule?e:{default:e}}function i(e,t,n,o,r,s,i){try{var a=e[s](i),c=a.value}catch(u){return void n(u)}a.done?t(c):Promise.resolve(c).then(o,r)}function a(e){return function(){var t=this,n=arguments;return new Promise((function(o,r){var s=e.apply(t,n);function a(e){i(s,o,r,a,c,"next",e)}function c(e){i(s,o,r,a,c,"throw",e)}a(void 0)}))}}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var h={components:{},data:function(){return{agreeUserInfo:!1,agreePhoneNum:!1,agreeTemplateMsg:!1,nearshop:{shopname:"",shopaddress:""},list:[],shopshow:!1,accreditshow:!1,phonenumshow:!1,templatemsgshow:!1,show:!1,height:0,currentShop:{}}},methods:u({tel:function(){e.makePhoneCall({phoneNumber:"15515772417",success:function(e){console.log("调用成功!")},fail:function(e){console.log("调用失败!")}})},openMap:function(){var t={latitude:parseFloat(this.currentShop.lat),longitude:parseFloat(this.currentShop.lng),name:this.currentShop.address+this.currentShop.name};e.openLocation(t)}},(0,r.mapMutations)(["login"]),{wxlogin:function(){var t=this;e.login({provider:"weixin",success:function(n){console.log("loginRes--"+n);var o=n.code;e.getUserInfo({provider:"weixin",success:function(n){console.log("infoRes--"+n);var r={code:o,user_info:n.rawData,encrypted_data:n.encryptedData,iv:n.iv,signature:n.signature};console.log(n.rawData),t.$H.post("/mannerdish/user/login",r,{token:!1}).then((function(n){t.login(n),e.showLoading({title:"loading",mask:!0}),t.agreeUserInfo=!1,t.accreditshow=!1,setTimeout((function(){e.hideLoading(),t.agreeTemplateMsg=!0,t.templatemsgshow=!0}),1e3)}))}})}})},showTemp:function(){var e=this;wx.requestSubscribeMessage({tmplIds:["nxyyDOAqE29fWEbvEM96ic-lv7W3LRuTJtO34zihDBk","FwqdpQ5V9rqfOM8vanxGHoxnaMHeyciPDenZssgwj7c"],success:function(t){e.agreeTemplateMsg=!1,e.templatemsgshow=!1,console.log("success:"+t.errMsg+"---"+t.errCode)},fail:function(e){console.log("fail:"+e.errMsg+"---"+e.errCode)},complete:function(e){console.log("complete:"+e.errMsg+"---"+e.errCode)}})},onReachBottom:function(){console.log("触底了，触发触底事件")},getPhoneNumber:function(e){var t=this;"getPhoneNumber:ok"!=e.detail.errMsg||(t.agreePhoneNum=!1,t.phonenumshow=!1,t.agreeTemplateMsg=!0,t.templatemsgshow=!0)},showshop:function(){this.show=!0,this.shopshow=!0},hidedeatil:function(){this.show=!1,this.shopshow=!1},showAgree:function(){this.agree=!0,this.accreditshow=!0},closeagreeuserinfo:function(){this.agreeUserInfo=!1,this.accreditshow=!1},closetemplatemsg:function(){this.agreeTemplateMsg=!1,this.templatemsgshow=!1},toList:function(){e.switchTab({url:"../../pages/mannerlist/mannerlist1"})},go:function(){e.switchTab({url:"../../pages/mannerlist/mannerlist"})},toOrder:function(){e.switchTab({url:"../../pages/mannerorder/ordertoday"})},info:function(){e.showLoading({title:"敬请期待"}),setTimeout((function(){e.hideLoading()}),1e3)},setCurrentShop:function(t){this.$Util.setCache("current_shop",this.list[t]),e.switchTab({url:"../../pages/mannerlist/mannerlist1"})},loadData:function(t,n,r){var s=this;return a(o.default.mark((function i(){var a;return o.default.wrap((function(o){while(1)switch(o.prev=o.next){case 0:a=s,s.$H.get("/mannerdish/index/index?lng="+t+"&lat="+n,{},{token:!0,cb:function(){a.agreeUserInfo=!0,a.accreditshow=!0}}).then((function(t){s.data=t,s.$Util.setCache("shop_list",t,0),s.nearshop.shopname=s.data[0].name,s.nearshop.shopaddress=s.data[0].address,s.nearshop.tel=s.data[0].tel;var n=s.data.splice(0,1);s.list=s.data,s.$Util.setCache("current_shop",n[0],0),setTimeout((function(){e.hideLoading()}),1e3),r&&r(t)}));case 2:case"end":return o.stop()}}),i)})))()},onLoad:function(){this.currentShop=this.$Util.getCache("current_shop");var t=this;wx.getLocation({type:"wgs84",success:function(n){e.showLoading({title:"加载中"}),t.loadData(n.longitude,n.latitude,(function(e){}))}})}})};t.default=h}).call(this,n("543d")["default"])},"73b7":function(e,t,n){"use strict";n.r(t);var o=n("4d3b"),r=n("04fb");for(var s in r)"default"!==s&&function(e){n.d(t,e,(function(){return r[e]}))}(s);n("817d");var i,a=n("f0c5"),c=Object(a["a"])(r["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],i);t["default"]=c.exports},"817d":function(e,t,n){"use strict";var o=n("84e1"),r=n.n(o);r.a},"84e1":function(e,t,n){}},[["06cf","common/runtime","common/vendor"]]]);